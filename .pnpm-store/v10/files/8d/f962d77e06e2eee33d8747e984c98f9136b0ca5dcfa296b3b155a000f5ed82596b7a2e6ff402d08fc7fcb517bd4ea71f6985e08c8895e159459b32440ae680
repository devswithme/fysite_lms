{"version":3,"sources":["../../../src/resolvers/collections/find.ts"],"sourcesContent":["import type { Collection, PaginatedDocs, PayloadRequest, Where } from 'payload'\n\nimport { findOperation, isolateObjectProperty } from 'payload'\n\nimport type { Context } from '../types.js'\n\nexport type Resolver = (\n  _: unknown,\n  args: {\n    data: Record<string, unknown>\n    draft: boolean\n    fallbackLocale?: string\n    limit?: number\n    locale?: string\n    page?: number\n    pagination?: boolean\n    sort?: string\n    trash?: boolean\n    where?: Where\n  },\n  context: {\n    req: PayloadRequest\n  },\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n) => Promise<PaginatedDocs<any>>\n\nexport function findResolver(collection: Collection): Resolver {\n  return async function resolver(_, args, context: Context) {\n    let { req } = context\n    const locale = req.locale\n    const fallbackLocale = req.fallbackLocale\n\n    req = isolateObjectProperty(req, ['locale', 'fallbackLocale', 'transactionID'])\n    req.locale = args.locale || locale\n    req.fallbackLocale = args.fallbackLocale || fallbackLocale\n    if (!req.query) {\n      req.query = {}\n    }\n\n    const draft: boolean =\n      (args.draft ?? req.query?.draft === 'false')\n        ? false\n        : req.query?.draft === 'true'\n          ? true\n          : undefined\n    if (typeof draft === 'boolean') {\n      req.query.draft = String(draft)\n    }\n\n    context.req = req\n\n    const options = {\n      collection,\n      depth: 0,\n      draft: args.draft,\n      limit: args.limit,\n      page: args.page,\n      pagination: args.pagination,\n      req,\n      sort: args.sort,\n      trash: args.trash,\n      where: args.where,\n    }\n\n    const results = await findOperation(options)\n    return results\n  }\n}\n"],"names":["findOperation","isolateObjectProperty","findResolver","collection","resolver","_","args","context","req","locale","fallbackLocale","query","draft","undefined","String","options","depth","limit","page","pagination","sort","trash","where","results"],"mappings":"AAEA,SAASA,aAAa,EAAEC,qBAAqB,QAAQ,UAAS;AAwB9D,OAAO,SAASC,aAAaC,UAAsB;IACjD,OAAO,eAAeC,SAASC,CAAC,EAAEC,IAAI,EAAEC,OAAgB;QACtD,IAAI,EAAEC,GAAG,EAAE,GAAGD;QACd,MAAME,SAASD,IAAIC,MAAM;QACzB,MAAMC,iBAAiBF,IAAIE,cAAc;QAEzCF,MAAMP,sBAAsBO,KAAK;YAAC;YAAU;YAAkB;SAAgB;QAC9EA,IAAIC,MAAM,GAAGH,KAAKG,MAAM,IAAIA;QAC5BD,IAAIE,cAAc,GAAGJ,KAAKI,cAAc,IAAIA;QAC5C,IAAI,CAACF,IAAIG,KAAK,EAAE;YACdH,IAAIG,KAAK,GAAG,CAAC;QACf;QAEA,MAAMC,QACJ,AAACN,KAAKM,KAAK,IAAIJ,IAAIG,KAAK,EAAEC,UAAU,UAChC,QACAJ,IAAIG,KAAK,EAAEC,UAAU,SACnB,OACAC;QACR,IAAI,OAAOD,UAAU,WAAW;YAC9BJ,IAAIG,KAAK,CAACC,KAAK,GAAGE,OAAOF;QAC3B;QAEAL,QAAQC,GAAG,GAAGA;QAEd,MAAMO,UAAU;YACdZ;YACAa,OAAO;YACPJ,OAAON,KAAKM,KAAK;YACjBK,OAAOX,KAAKW,KAAK;YACjBC,MAAMZ,KAAKY,IAAI;YACfC,YAAYb,KAAKa,UAAU;YAC3BX;YACAY,MAAMd,KAAKc,IAAI;YACfC,OAAOf,KAAKe,KAAK;YACjBC,OAAOhB,KAAKgB,KAAK;QACnB;QAEA,MAAMC,UAAU,MAAMvB,cAAce;QACpC,OAAOQ;IACT;AACF"}